---
layout: single
title: W-02(Guest 기본 계정 활성화 여부 점검)
categories: WindowsServer_Assessment
tag: [Guest,주요정보통신기반, 취약점점검, 진단스크립트, 윈도우취약점진단]
toc: true
author_profile: false
---

💡 **<u>알림</u>** 해당 스크립트는 <u style="font-style: italic;">"주요정보통신기반시설 기술적 취약점 분석ㆍ평가 방법 상세가이드"</u> 를 기반으로 작성되었습니다.
{: .notice--primary} 

# 계정 관리
## W-02 : Guest 기본 계정 활성화 여부 점검 여부
 
| 항목 | 내용 |
|------|------|
| **점검내용** | Guest 기본 계정 활성화 여부 |
| **점검목적** | Guest 계정이 활성화된 경우, 공격자가 이를 악용하여 시스템에 접근할 수 있는 가능성을 줄이기 위해 기본 Guest 계정의 비활성화 또는 추가적인 보안 조치를 통해 보호 |
| **위험도** | 높음 (상) |
| **판단기준** | 양호 : Guest Default 계정을 비활성화한 경우 또는 활성화 시 강력한 보안 조치를 적용한 경우<br>취약 : Guest Default 계정을 활성화한 상태에서 기본 설정을 유지한 경우 |
| **조치방법** | 기본 Guest 계정 비활성화<br>- 비활성화가 어려운 경우, 제한된 권한 설정 및 강력한 비밀번호 정책 적용<br>- 계정 사용 로그 모니터링 및 비정상 활동 탐지 |
| **보안위협점검 및 조치사례** | **점검사례**: 조직 A는 기본 Guest 계정을 비활성화하고, 모든 공용 접근 계정에 대해 강력한 비밀번호 정책과 접근 제한 규칙을 적용하여 보안을 강화하였습니다.<br>**조치사례**: 조직 B는 기본 Guest 계정을 활성화한 상태로 두었지만, 계정에 대한 접근 시도를 지속적으로 모니터링하고 비정상적인 활동을 탐지하여 즉시 대응하는 시스템을 구축하였습니다. |

# 진단 방법
[windows NT]
1. 시작> 프로그램> 관리도구> 도메일 사용자 관리> 등록된 계정 확인

![alt text](image.png)
<img src="/assets/image/Vulnerability_Assessment/windows_scripts/W-02/image.png" alt="description" width="600"/>

2. CMD > net user 에서 Guest 확인 > net user Guest > Account active 옵션값 확인 Yes 일경우 활성화, No 일경우 비 활성화

## 진단 스크립트
<div class="notice">
  REM [W-02] Guest 계정 정보 조회 계정 정보 조회<br>
  @echo off<br>
  chcp 65001<br><br>

  echo ## Guest 계정 정보 조회 ##<br><br>

  # guest 계정에 대한 정보를 반환받아 "account acive" 문자열이 포함된 라인을 출력한다. 해당 출력된 반환값에서 Yes 문자열이 포함된 라인을 다시한번 출력한다. guest 계정 정보에서 account acitve 값이 Yes 로 설정되면 Guest 계정을 활성화 한다는 의미로 취약하다.
  net user guest | find /I "account active" | findstr  "Yes"
  echo [점검 기준] >> %HNAME%.%DATE%.txt
  echo [양호] echo 윈도우의 기본 Guest 계정명 비활성화 상태임 
  echo [취약] echo 윈도우의 기본 Guest 계정명 활성화 상태임  

  # net user guest | find /I "account active" | findstr  "Yes" 명령어의 결과로 출력값이 존재하면 errorlevel 변수에 0이 설정되어 취약하고, 출력값이 존재하지 않는다면 1로 설정되어 양호하다.
  echo [점검결과]    
  If %errorlevel% == 0  echo 취약 
  If Not %errorlevel% == 0  echo 양호 


  pause
</div>

# 보안대책
- Guest 계정 비활성화

[windows NT]
1. 시작> 프로그램> 관리도구> 도메일 사용자 관리> Guest 계정 선택> 등록정보
2. "계정 사용 안함"에 체크

[Windows 2000, 2003, 2008, 2012, 2016, 2019]
1. 시작> 실행> LUSRMGR.MSC> 사용자> GUEST> 속성
2. 계정 사용 안 함"에 체크

[windows 11 Home]
1. 시작> 제어판 > 사용자 계정 > 계정 관리 > Guest > 삭제
2. cmd > net user guest /active:no 입력