---
layout: single
title: U-01(Administrator root 계정 원격 접속 제한)
categories: LinuxServer_Assessment
tag: [root,주요정보통신기반, 취약점점검, 진단스크립트, 리눅스취약점진단]
toc: true
author_profile: false
---

💡 **<u>알림</u>** 해당 스크립트는 <u style="font-style: italic;">"주요정보통신기반시설 기술적 취약점 분석ㆍ평가 방법 상세가이드"</u> 를 기반으로 작성되었습니다.
{: .notice--primary} 

# 계정 관리
## U-01 : root 계정 원격 접속 제한

| 항목 | 내용 |
|------|------|
| **점검내용** | root 계정 원격 접속 제한 |
| **점검목적** | 공격자가 root 계정을 통해 시스템에 직접 접근하여 악용하는 것을 방지하기 위해 root 계정의 원격 접속을 제한하거나 추가적인 보안 조치를 통해 보호 |
| **위험도** | 높음 (상) |
| **판단기준** | 양호 : root 계정의 원격 접속을 제한하거나 추가적인 보안 조치를 적용한 경우<br>취약 : root 계정의 원격 접속을 제한하지 않거나 단순한 보안 조치만 적용한 경우 |
| **조치방법** | root 계정 원격 접속 제한<br>- SSH 설정 파일(sshd_config)에서 PermitRootLogin 옵션을 no로 설정<br>- root 계정 원격 접속이 필요한 경우, 강력한 비밀번호 정책 적용 및 이중 인증(2FA) 설정<br>- sudo를 사용하여 일반 사용자 계정에서 필요한 경우 root 권한을 사용할 수 있도록 설정<br>- 계정 사용 로그 모니터링 및 비정상 활동 탐지 |
| **보안위협점검 및 조치사례** | **점검사례**: 조직 A는 SSH 설정 파일에서 root 계정의 원격 접속을 금지하고, 일반 사용자 계정을 통해 sudo로 필요한 작업을 수행하게 하였습니다.<br>**조치사례**: 조직 B는 root 계정 원격 접속을 허용하되, 강력한 비밀번호와 이중 인증을 적용하고, 접근 시도를 모니터링하며 비정상적인 활동을 탐지하여 즉시 대응하는 시스템을 구축하였습니다. |

# 진단 방법

1. /etc/pam.d/login | grep auth >  auth required /lib/security/pam_securetty.so 가 활성화 되어있는 지 확인 (비활성화(주석처리) 의 경우 취약함으로 판단.)
2. /etc/securetty 파일에서 pts/0 ~ pts/x 관련 설정이 존재 유무 확인 (존재 할 경우 취약)
3. /etc/sshd_config 에서 PermitRootLogin 설정값 확인 (Yes로 설정된 경우 취약)

## 진단 스크립트
<div class="notice">
  if pgrep "telnetd" > /dev/null; then<br>
    echo "Telnet 서비스: 동작 중"<br>
    if [ -f "/etc/securetty" ]; then<br>
        echo "/etc/securetty 파일: 존재함"<br>
        if grep -q "pts" "/etc/securetty"; then<br>
            echo "  - pts 항목: 발견됨 - 취약"<br>
        else<br>
            echo "  - pts 항목: 발견되지 않음 - 양호"<br>
        fi<br>
    else<br>
    	echo "/etc/securetty 파일이 존재하지 않습니다."<br>
    fi<br><br>
    
    if [ -f "/etc/pam.d/login" ]; then<br>
    	echo "/etc/pam.d/login 파일이 존재합니다."<br>
    	if grep -q "auth required /lib/security/pam_securetty.so" "/etc/pam.d/login"; then<br>
    	    echo "auth required /lib/security/pam_securetty.so 항목: 발견됨 - 양호."<br>
    	else<br>
   	    echo "auth required /lib/security/pam_securetty.so 항목: 비활성화 - 취약."<br>
    	fi<br>
    else<br>
    	echo "/etc/pam.d/login 파일이 존재하지 않습니다."<br>
    fi<br>
else<br>
    echo "telnet 프로세스: 동작 중이 아님"<br>
fi<br><br>

if pgrep "sshd" > /dev/null; then<br>
    echo "sshd 프로세스: 동작 중"<br>
    if [ -f "/etc/ssh/sshd_config" ]; then<br>
        echo "/etc/ssh/sshd_config 파일: 존재함"<br>
        if grep -q "^PermitRootLogin no" "/etc/ssh/sshd_config"; then<br>
            echo "  - PermitRootLogin no: 발견됨 - 양호"<br>
        else<br>
            echo "  - PermitRootLogin no: 발견되지 않음 - 취약"<br>
        fi<br>
    else<br>
        echo "/etc/ssh/sshd_config 파일: 존재하지 않음"<br>
    fi<br>
else<br>
    echo "sshd 프로세스: 동작 중이 아님"<br>
fi<br>
</div>

# 보안대책
- Administrator 계정의 계정명을 변경 및 보안성이 있는 비밀번호로 변경 조치 한다.

1. /etc/pam.d/login 파일에서 auth required /lib/security/pam_securetty.so 추가 및 주석제거
2. /etc/securetty 파일에서 pts/0 ~ pts/x 설정 제거 또는, 주석 처리
3. /etc/ssh/sshd_config 파일에서 PermitRootLogin No 설정